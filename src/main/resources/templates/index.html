<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <!--å¼•å…¥å…¬å…±headéƒ¨åˆ†-->
    <th:block th:include="~{common::commonHead}"></th:block>
    <title>é¦–é¡µ</title>
    <style>
        .h-20{height: 20%;}
        .fs-9{font-size: 0.9em;}
        .w-2x{width: 24%; transition: all 0.3s;}
        .h-200{height: 160px;}
    </style>
</head>
<body>
<!-- ç¬¬ä¸€éƒ¨åˆ† å¯¼èˆªæ  -->
<div th:replace="~{common::memberNav}"></div>

<!-- ç¬¬äºŒéƒ¨åˆ†  å·¦å›¾ç‰‡è½®æ’­  å³é€šçŸ¥å…¬å‘Š -->
<div class="container-fluid d-flex justify-content-between mt-2">
    <div class="border border-2 p-2 rounded shadow" style="width: 65%;">
        <div class="d-flex justify-content-between mb-2">
            <div><button class="btn btn-secondary disabled">çƒ­é—¨å£çº¸</button></div>
            <div><a class="text-muted btn btn-secondary" th:href="@{/resDetail(act='moreW')}">more</a></div>
        </div>
        <div id="carouselExampleIndicators" class="carousel slide" data-bs-ride="carousel">
            <div class="carousel-indicators">
                <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1" aria-label="Slide 2"></button>
                <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2" aria-label="Slide 3"></button>
            </div>
            <div class="carousel-inner">
                <div class="carousel-item active" data-bs-interval="4000">
                    <img th:src="@{/img/1.jpg}" class="d-block w-100 rounded" alt="...">
                </div>
                <div class="carousel-item" data-bs-interval="4000">
                    <img th:src="@{/img/2.jpg}" class="d-block w-100 rounded" alt="...">
                </div>
                <div class="carousel-item" data-bs-interval="4000">
                    <img th:src="@{/img/3.jpg}" class="d-block w-100 rounded" alt="...">
                </div>
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>
    </div>
    <div class="border border-1 p-2 rounded shadow" style="width: 34%;">
        <div class="d-flex justify-content-between mb-2">
            <div><button class="btn btn-secondary disabled">é€šçŸ¥å…¬å‘Š</button></div>
            <div><a class="text-muted btn btn-secondary" th:href="@{/noticeMem/noticeList}">more</a></div>
        </div>
        <div class="d-flex flex-column" style="height: 536px;" id="noticeDiv"></div>
    </div>
</div>

<!-- ç¬¬ä¸‰éƒ¨åˆ† å…·ä½“å†…å®¹ -->
<!--å®ç”¨è½¯ä»¶-->
<div class="container-fluid p-5" id="soft">
    <!-- æ ‡é¢˜ -->
    <div style="height: 38px;">
        <div class="float-start">
            <span class="fs-4">å®ç”¨è½¯ä»¶</span>
            <span class="text-muted fs-9">ç”¨å¥½æ–¹æ³•ä¸å·¥å…·ï¼Œæ˜¯é«˜æ•ˆå®Œæˆäº‹æƒ…çš„æœ‰æ•ˆé€”å¾„ï¼ğŸ’‰</span>
        </div>
        <div class="float-end d-flex">
            <a class="d-block ms-3 text-decoration-none btn bg-success-subtle rounded-pill" id="a1"></a>
            <a class="d-block ms-3 text-decoration-none btn bg-success-subtle rounded-pill" id="a2"></a>
            <a class="d-block ms-3 text-decoration-none btn bg-success-subtle rounded-pill" id="a3"></a>
        </div>
    </div>
    <!-- åˆ—ä¸¾éƒ¨åˆ†-->
    <div class="mt-2 d-flex flex-wrap justify-content-between align-content-between" id="con1">
    </div>
</div>
<!--çƒ­é—¨èµ„æ–™-->
<div class="container-fluid p-5 pt-0" id="doc">
    <!-- æ ‡é¢˜ -->
    <div style="height: 38px;">
        <div class="float-start">
            <span class="fs-4">çƒ­é—¨èµ„æ–™</span>
            <span class="text-muted fs-9">çƒ­é—¨èµ„æ–™æ±‡èšï¼Œè½»æ¾æŒæ¡å‰æ²¿åŠ¨æ€ä¸å®ç”¨å¹²è´§ï¼â˜º</span>
        </div>
    </div>
    <!-- åˆ—ä¸¾éƒ¨åˆ†-->
    <div class="mt-2 d-flex flex-wrap justify-content-between align-content-between" id="con2">
    </div>
</div>
<!--å£çº¸-->
<div class="container-fluid p-5 pt-0" id="wall">
    <!-- æ ‡é¢˜ -->
    <div style="height: 38px;">
        <div class="float-start">
            <span class="fs-4">å£çº¸</span>
            <span class="text-muted fs-9">ç²¾ç¾å£çº¸ï¼Œè£…ç‚¹æ•°å­—ä¸–ç•Œï¼Œè®©ç›®å…‰åœç•™æˆäº«å—ï¼â€</span>
        </div>
    </div>
    <!-- åˆ—ä¸¾éƒ¨åˆ†-->
    <div class="mt-2 d-flex flex-wrap justify-content-between align-content-between" id="con3">
    </div>
</div>

<!-- æœ€ä¸‹é¢çš„åº•éƒ¨-->
<div th:replace="~{common::memberFoot}"></div>

<!-- Modal -->
<div class="modal fade" id="shareModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="shareModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="shareModalLabel">åˆ†äº«ä¸Šä¼ </h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body container">
                <form id="shareForm" method="post" th:action="@{/resDetail(act=upload)}" enctype="multipart/form-data">
                    <div class="row">
                        <div class="col-md-7">
                            <label for="res" class="form-label">ä¸Šä¼ èµ„æº</label>
                            <input type="file" class="form-control" id="res" name="res">
                        </div>
                        <div class="col-md-5">
                            <label for="type" class="form-label">èµ„æºç±»å‹</label>
                            <select id="type" class="form-select" name="type">
                                <option value="11">å£çº¸-é£æ™¯</option>
                                <option value="12">å£çº¸-ç¾å¥³</option>
                                <option value="13">å£çº¸-è®¾è®¡</option>
                                <option value="14">å£çº¸-å†›äº‹</option>
                                <option value="2">è½¯ä»¶</option>
                                <option value="3">èµ„æ–™</option>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <label for="type" class="form-label">æè¿°</label>
                            <input class="form-control" id="display" name="display" type="text" maxlength="18">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-7" id="th">
                            <label for="img" class="form-label">ç¼©ç•¥å›¾</label>
                            <input type="file" class="form-control" id="img" name="img">
                        </div>
                        <div class="col-md-5">
                            <label for="gold" class="form-label">é‡‘å¸</label>
                            <input type="text" class="form-control" id="gold" name="gold" value="0">
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="shareBtn" disabled>ä¸Šä¼ </button>
            </div>
        </div>
    </div>
</div>

<!--toast-->
<div class="toast-container position-fixed bottom-0 end-0 p-3">
    <div id="liveToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-header">
            <img th:src="@{/img/favicon.ico}" width="20px" class="rounded me-2" alt="...">
            <strong class="me-auto">é¦–é¡µ</strong>
            <small>åˆšåˆš</small>
            <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
        <div class="toast-body" th:if="${msg}" th:text="${msg}"></div>
        <div class="toast-body" th:if="${m==0}" th:text="ç­¾åˆ°æˆåŠŸ"></div>
        <div class="toast-body" th:if="${m==1}" th:text="ä»Šæ—¥å·²ç­¾"></div>
    </div>
</div>
<script>
    $("#shareBtn").click(function (){
        $("#shareForm").submit();
    })

    let b1=false;
    let b2=true;
    let b3=false;
    let b4=false;
    let b5=true;
    $("#gold").blur(function (){
        let val3 = $("#gold").val();
        if(val3!=null&&val3.trim().length>0){
            b5=true;
            check();
        }else{
            b5=false;
            check();
        }
    })

    $("#res").change(function (){
        let val = this.files[0];
        b1=true;
        check()
    })

    $("#type").change(function (){
        let val1 = $("#type").val();
        if(val1!=null){
            b2=true;
            check();
        }else{
            b2=false;
            check();
        }
    })

    $("#display").blur(function (){
        let val2 = $("#display").val();
        if(val2!=null&&val2.trim().length>0){
            b3=true;
            check();
        }else{
            b3=false;
            check();
        }
    })

    $("#img").change(function (){
        let val = this.files[0];
        b4=true;
        check()
    })

    function check(){
        console.log(b1+"1")
        console.log(b2+"2")
        console.log(b3+"3")
        console.log(b4+"4")
        console.log(b5+"5")
        if(b1&&b2&&b3&&b4&&b5){
            $("#shareBtn").prop("disabled",false);
        }else{
            $("#shareBtn").prop("disabled",true);
        }
    }

    $("#searchBtn").click(function (e){
        let val = $("#search").val();
        if(val==null||val.trim().length==0){
            e.preventDefault();
        }
    })

    $(function(){
        let text=$(".toast-body").text();
        if(text!=null&&text.length>0){
            let toastLiveExample = document.getElementById('liveToast')
            let toast = new bootstrap.Toast(toastLiveExample)
            toast.show()
        }
    })


    $(function (){
        $.ajax({
            url:'/ex/noticeMember',
            type:'post',
            data:'act=selectAll',
            dataType:'json',
            success:function (ns){
                for (let i = 0; i < ns.length; i++) {
                    let notice =ns[i];
                    let $div=$(`<div class="h-20 bg-primary-subtle rounded p-2 border-bottom border-warning border-2"></div>`);
                    let $p=$("<p class='text-white'></p>");
                    let $span=$("<span class='text-warning fs-3'></span>")
                    let day=notice.day
                    let ym=notice.ym
                    $span.append(day)
                    $p.append($span).append(ym)
                    let $a=$(`<a class="text-white text-decoration-none" href=""></a>`);
                    let id=notice.id;
                    let href="/ex/noticeMem/detail?id="+id;
                    $a.attr("href",href);
                    $a.text(notice.title)
                    $div.append($p).append($a);
                    $("#noticeDiv").append($div);
                }
            }
        })
    })

    //ä½¿ç”¨äº‹ä»¶å§”æ‰˜æ¥è§£å†³åŠ¨æ€ç”Ÿæˆå†…å®¹çš„äº‹ä»¶ç»‘å®šé—®é¢˜
    // åŠ¨æ€ç”Ÿæˆçš„å¯¹è±¡,äº‹ä»¶ç»‘å®šåˆ°æ ¹ç›®å½•ä¸Šå¯ä»¥ç¡®ä¿å…¶æ­£ç¡®ç»‘å®šäº‹ä»¶
    $(document).on('mouseenter','.w-2x',function (){
        $(this).addClass("shadow");
    }).on('mouseleave','.w-2x',function (){
        $(this).removeClass("shadow");
    })

    $(".myfoot a").hover(function(){
        $(this).removeClass("text-muted").addClass("text-warning");
    },function(){
        $(this).removeClass("text-warning").addClass("text-muted");;
    })

    $("#logoutBtn").click(function (e){
        let b = confirm("ç¡®å®šè¦é€€å‡ºå—?");
        if(!b){
            e.preventDefault();
        }
    })

    $("#personalInfoBtn").click(function (){
        window.location.href="/ex/member/updateSession";
    })

    $(function (){
        $.ajax({
            url:'/ex/resload',
            type:'post',
            data:'type=2',
            dataType:'json',
            success:function (list){
                for (let i = 0; i < list.length; i++) {
                    let res=list[i];
                    let href="/ex/resDetail?type=2&id="+res.id;
                    if(i==0){
                        $("#a1").text(res.resname).prop("href",href)
                    }else if(i==1){
                        $("#a2").text(res.resname).prop("href",href)
                    }else if(i==2){
                        $("#a3").text(res.resname).prop("href",href)
                    }
                    let container = $("#con1");
                    let a = $(`<a class="d-block w-2x text-decoration-none h-200  mb-3 border rounded p-2"></a>`);
                    a.prop("href",href);
                    let c1 = $(`<div class="d-flex"></div>`);
                    let c11 = $(`<div></div>`);
                    let img = $(`<img src="" width="54px" height="54px" class="border rounded"/>`);
                    let src='[[${application.icon}]]'+res.thumbnail
                    img.prop("src",src);
                    c11.append(img);
                    c1.append(c11);
                    let c12 = $(`<div class="ms-2 text-muted fs-9"></div>`);
                    let name=res.resname;
                    c12.text(name);
                    let br=$(`<br/>`)
                    c12.append(br)
                    let button1=$(`<button class="btn-sm bg-success-subtle disabled fs-9 text-muted border-0 rounded"></button>`)
                    let free=res.isFree;
                    if(free==0){
                        button1.text("å…è´¹")
                    }else{
                        button1.text(free+"é‡‘å¸");
                    }
                    c12.append(button1)
                    c1.append(c12)
                    a.append(c1)
                    let p=$(`<p class="text-muted fs-9 my-3"></p>`)
                    p.text(res.display)
                    a.append(p)
                    let c2=$(`<div class="d-flex justify-content-between"></div>`)
                    let c21=$(`<div></div>`)
                    let span1=$(`<span class="fs-9 text-muted"></span>`)
                    let svg1=$(`<img src="/ex/img/calendar.svg"/>`)
                    span1.append(svg1)
                    let date=String(res.joindate)
                    span1.append(date.substring(5,10))
                    c21.append(span1)
                    let span2=$(`<span class="ms-2 fs-9 text-muted"></span>`)
                    let svg2=$(`<img src="/ex/img/look.svg"/>`)
                    span2.append(svg2)
                    span2.append(res.pv)
                    c21.append(span2)
                    c2.append(c21)
                    let c22=$(`<div></div>`)
                    let button2=$(`<a class="btn btn-sm btn-outline-success rounded-pill">è·å–</a>`)
                    let getId="get"+res.id;
                    let href1="/ex/resDetail/download?type=2&id="+res.id;
                    button2.prop("href",href1).prop("id",getId).prop("name",free);
                    c22.append(button2)
                    c2.append(c22)
                    a.append(c2)
                    container.append(a);
                }
            }
        })
    })

    $(function (){
        $.ajax({
            url:'/ex/resload',
            type:'post',
            data:'type=3',
            dataType:'json',
            success:function (list){
                for (let i = 0; i < list.length; i++) {
                    let res=list[i];
                    let container = $("#con2");
                    let a = $(`<a class="d-block w-2x text-decoration-none h-200  mb-3 border rounded p-2"></a>`);
                    let href="/ex/resDetail?type=3&id="+res.id;
                    a.prop("href",href);
                    let c1 = $(`<div class="d-flex"></div>`);
                    let c11 = $(`<div></div>`);
                    let img = $(`<img th:src="" width="54px" height="54px" class="border rounded"/>`);
                    let src="[[${application.icon}]]"+res.thumbnail
                    img.prop("src",src);
                    c11.append(img);
                    c1.append(c11);
                    let c12 = $(`<div class="ms-2 text-muted fs-9"></div>`);
                    let name=res.resname;
                    c12.text(name);
                    let br=$(`<br/>`)
                    c12.append(br)
                    let button1=$(`<button class="btn-sm bg-success-subtle disabled fs-9 text-muted border-0 rounded"></button>`)
                    let free=res.isFree;
                    if(free==0){
                        button1.text("å…è´¹")
                    }else{
                        button1.text(free+"é‡‘å¸");
                    }
                    c12.append(button1)
                    c1.append(c12)
                    a.append(c1)
                    let p=$(`<p class="text-muted fs-9 my-3"></p>`)
                    p.text(res.display)
                    a.append(p)
                    let c2=$(`<div class="d-flex justify-content-between"></div>`)
                    let c21=$(`<div></div>`)
                    let span1=$(`<span class="fs-9 text-muted"></span>`)
                    let svg1=$(`<img src="/ex/img/calendar.svg"/>`)
                    span1.append(svg1)
                    let date=String(res.joindate)
                    span1.append(date.substring(5,10))
                    c21.append(span1)
                    let span2=$(`<span class="ms-2 fs-9 text-muted"></span>`)
                    let svg2=$(`<img src="/ex/img/look.svg"/>`)
                    span2.append(svg2)
                    span2.append(res.pv)
                    c21.append(span2)
                    c2.append(c21)
                    let c22=$(`<div></div>`)
                    let button2=$(`<a class="btn btn-sm btn-outline-success rounded-pill">è·å–</a>`)
                    let getId="get"+res.id;
                    let href1="/ex/resDetail/download?type=3&id="+res.id;
                    button2.prop("href",href1).prop("id",getId).prop("name",free);
                    c22.append(button2)
                    c2.append(c22)
                    a.append(c2)
                    container.append(a);
                }
            }
        })
    })

    $(function (){
        $.ajax({
            url:'/ex/resload',
            type:'post',
            data:'type=1',
            dataType:'json',
            success:function (list){
                for (let i = 0; i < list.length; i++) {
                    let res=list[i];
                    let container = $("#con3");
                    let a = $(`<a class="d-block w-2x text-decoration-none h-200  mb-3 border rounded p-2"></a>`);
                    let href="/ex/resDetail?type=1&id="+res.id;
                    a.prop("href",href);
                    let c1 = $(`<div class="d-flex"></div>`);
                    let c11 = $(`<div></div>`);
                    let img = $(`<img th:src="" width="100px" height="54px" class="border rounded"/>`);
                    let src="[[${application.img}]]"+res.thumbnail
                    img.prop("src",src);
                    c11.append(img);
                    c1.append(c11);
                    let c12 = $(`<div class="ms-2 text-muted fs-9"></div>`);
                    let name=res.resname;
                    c12.text(name);
                    let br=$(`<br/>`)
                    c12.append(br)
                    let button1=$(`<button class="btn-sm bg-success-subtle disabled fs-9 text-muted border-0 rounded"></button>`)
                    let free=res.isFree;
                    if(free==0){
                        button1.text("å…è´¹")
                    }else{
                        button1.text(free+"é‡‘å¸");
                    }
                    c12.append(button1)
                    c1.append(c12)
                    a.append(c1)
                    let p=$(`<p class="text-muted fs-9 my-3"></p>`)
                    p.text(res.display)
                    a.append(p)
                    let c2=$(`<div class="d-flex justify-content-between"></div>`)
                    let c21=$(`<div></div>`)
                    let span1=$(`<span class="fs-9 text-muted"></span>`)
                    let svg1=$(`<img src="/ex/img/calendar.svg"/>`)
                    span1.append(svg1)
                    let date=String(res.joindate)
                    span1.append(date.substring(5,10))
                    c21.append(span1)
                    let span2=$(`<span class="ms-2 fs-9 text-muted"></span>`)
                    let svg2=$(`<img src="/ex/img/look.svg"/>`)
                    span2.append(svg2)
                    span2.append(res.pv)
                    c21.append(span2)
                    c2.append(c21)
                    let c22=$(`<div></div>`)
                    let button2=$(`<a class="btn btn-sm btn-outline-success rounded-pill">è·å–</a>`)
                    let getId="get"+res.id;
                    let href1="/ex/resDetail/download?type=1&id="+res.id;
                    button2.prop("href",href1).prop("id",getId).prop("name",free);
                    c22.append(button2)
                    c2.append(c22)
                    a.append(c2)
                    container.append(a);
                }
            }
        })
    })
    $(document).on("click","a[id^=get]",function (e){
        let gold =Number("[[${session.member.gold}]]") ;
        console.log("gold=="+gold)
        let isFree = Number($(this).prop("name"));
        console.log("isFree=="+isFree)
        if(gold<isFree){
            alert("é‡‘å¸ä¸è¶³,æ— æ³•ä¸‹è½½");
            e.preventDefault();
        }
    })
</script>
</body>
</html>